<!DOCTYPE html>
<html>

<head>
    <title>Custom Integration Example Table</title>
    <!-- <link rel="stylesheet" href="integrationExample.css" /> -->
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
    
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
    
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
    
        th {
            background-color: #4CAF50;
            color: white;
        }
    </style>
    <script>
        geotab.addin.integrationExample = function (api, state) {
            var center = document.getElementById("center"),
                tableCreator = function (entities) {
                    var tableElement = document.createElement("TABLE");
                    var thead = document.createElement("THEAD");
                    var tbody = document.createElement("TBODY");
                    var tr = document.createElement("TR");
                    var th = document.createElement("TH");
                    th.textContent = "Name";
                    tr.appendChild(th);
                    thead.appendChild(tr);
                    tableElement.appendChild(thead);

                    entities.forEach(function (entity) {
                        var tr = document.createElement("TR");
                        var td = document.createElement("TD");
                        td.textContent = entity.name;
                        td.setAttribute("data-id", entity.id);
                        tr.appendChild(td);
                        tbody.appendChild(tr);
                    });

                    tableElement.appendChild(tbody);
                    return tableElement;
                },
                refreshPage = function () {
                    api.call("Get", {
                        typeName: "Device",
                        resultsLimit: 10
                    }, function (result) {
                        center.addEventListener("click", goToVehicles, false);
                        center.appendChild(listCreator(result));
                    }, function (error) {
                        console.log(error.message);
                    });
                },
                clearOnLeaving = function () {
                    center.removeEventListener("click", goToVehicles, false);
                    center.innerHTML = "";
                };

            return {
                initialize: function (api, state, callback) {
                    document.getElementById("vehiclesButton")
                        .addEventListener("click", function () {
                            state.gotoPage("devices");
                        }, false);
                    callback();
                },
                focus: function (api, state) {
                    refreshPage();
                },
                blur: function (api, state) {
                    clearOnLeaving();
                }
            }
        };
    </script>
</head>

<body>
    <div id="center">
        <button id="vehiclesButton">Go to vehicles page</button>
    </div>
</body>

</html>